<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Touch Fuzzy</title>

    <style id="page-css">
      .sr-only {
        position: absolute;
        clip: rect(1px, 1px, 1px, 1px);
        clip-path: inset(50%);
        width: 1px;
        height: 1px;
        overflow: hidden;
        padding: 0;
        border: 0;
        white-space: nowrap;
      }

      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      html {
        min-height: 100vh;

        font-size: calc(1rem + 1vw);
        line-height: 1.5;
        font-family: BlinkMacSystemFont, -apple-system, "Segoe UI", "Roboto",
          "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans",
          "Helvetica Neue", "Helvetica", "Arial", sans-serif;
      }
      body {
        display: flex;
        flex-flow: column;
        align-items: center;
        justify-content: center;

        min-height: 100vh;
        margin: 0;
        padding: calc(1rem + 1vw);

        background-color: #fdf4e8;
      }
      main {
        flex: 1;

        display: flex;
        flex-flow: column;
        align-items: center;
        justify-content: center;
        justify-content: space-evenly;
      }
      footer {
        font-size: 0.75em;
      }
      details {
        font-size: 0.8em;
      }
      summary {
        font-style: italic;
      }

      a {
        color: mediumblue;
        text-decoration: underline;

        text-decoration-style: dotted;
        text-decoration-thickness: 0.1em;

        transition-property: color, opacity, background-color, transform, filter,
          box-shadow;
        transition-duration: 250ms;
        transition-timing-function: ease-in-out;
      }
      a:not([class]) {
        text-decoration-skip-ink: auto;
      }
      a:hover {
        filter: saturate(150%);
      }
      a:focus {
        box-shadow: 0 0 0 3px royalblue;
      }

      a.button {
        display: inline-block;
        padding: 0.25em 0.75em;
        line-height: 1.2;

        color: black;
        background-color: lightskyblue;
        border-radius: 4px;

        text-decoration: none;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-weight: 500;
        text-align: center;
      }

      p,
      ol,
      ul {
        margin-bottom: 1.25em;
      }
      li {
        margin-top: 0.5em;
        margin-bottom: 0.5em;
      }

      input,
      button,
      textarea,
      select {
        font: inherit;
      }
    </style>
    <style id="bookmarklet-css">
      :root {
        --animation-delay: 10s;
        --animation-duration: 30s;
        --animation-warp: 8s;
        --degree-warp: 0deg;
      }
      * {
        animation-duration: var(--animation-duration),
          calc(var(--animation-duration) + var(--animation-warp)),
          calc(var(--animation-duration) + var(--animation-warp) * 2);
        animation-iteration-count: infinite;
        animation-direction: alternate;
        animation-delay: var(--animation-delay);
      }

      body {
        animation-name: skew;
        animation-delay: 60s;
      }

      figure,
      img,
      picture,
      video,
      iframe,
      svg,
      canvas,
      input,
      textarea,
      button,
      pre,
      hr {
        animation-name: hueRotate, scale3D, origin;
      }
      p,
      li,
      dd,
      dt,
      dl,
      figcaption,
      blockquote,
      cite,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      a,
      strong,
      em {
        --animation-duration: 5s;
        animation-name: blur, skew;
      }

      @keyframes hueRotate {
        from {
          filter: hue-rotate(0deg) saturate(100%);
        }
        to {
          filter: hue-rotate(180deg) saturate(120%);
        }
      }
      @keyframes scale3D {
        from {
          transform: scale3D(0.95, 0.95, 1) skew(-1deg, -1deg);
        }
        to {
          transform: scale3D(1.25, 1.25, 1) skew(1deg, 1deg);
        }
      }
      @keyframes skew {
        0% {
          transform: skew(0deg, 0deg);
        }
        33% {
          transform: skew(0.5deg, 0.5deg);
        }
        66% {
          transform: skew(-0.5deg, -0.5deg);
        }
        100% {
          transform: skew(0deg, 0deg);
        }
      }
      @keyframes origin {
        0% {
          transform-origin: 50% 50%;
        }
        20% {
          transform-origin: 40% 50%;
        }
        40% {
          transform-origin: 60% 40%;
        }
        60% {
          transform-origin: 40% 60%;
        }
        80% {
          transform-origin: 50% 40%;
        }
        100% {
          transform-origin: 50% 50%;
        }
      }

      @keyframes blur {
        from {
          filter: blur(0em) contrast(100%);
        }
        to {
          filter: blur(0.05em) contrast(200%);
        }
      }
    </style>
  </head>
  <body>
    <main>
      <article>
        <h1>touchfuzzy</h1>
        <ol>
          <li>
            Drag this to your bookmarks bar:
            <a id="bookmarklet-link" class="button" href="#">ðŸŒ€</a>
          </li>
          <li>
            Go to a website with a bunch of stuff on it.
          </li>
          <li>
            Click the ðŸŒ€.
          </li>
          <li>
            Wait.
          </li>
        </ol>
      </article>

      <details>
        <summary>Bookmarks bar? I'm on a phone.</summary>
        <p>
          Try
          <a
            href="https://www.cultofmac.com/500532/how-to-add-bookmarklet-mobile-iphone-safari/"
            target="_blank"
            >this</a
          >, using this code:
        </p>
        <label class="sr-only" for="bookmarklet-text">Bookmarklet Source</label>
        <textarea
          readonly
          name="bookmarklet-text"
          id="bookmarklet-text"
        ></textarea>
      </details>
    </main>
    <footer>
      <a href="https://github.com/cbirdsong/touchfuzzy" target="_blank"
        >source</a
      >
    </footer>

    <script id="bookmarklet-js">
      function getDizzy() {
        var things = document.querySelectorAll("*");
        for (var thing of things) {
          var time = 5 + Math.floor(Math.random() * Math.floor(30));
          thing.style.setProperty("--animation-delay", time * 1.5 + "s");
          thing.style.setProperty("--animation-warp", time * 2.5 + "s");

          var deg = Math.random();
          thing.style.setProperty("--degree-warp", deg + deg * 0.5 + "deg");
        }
      }
    </script>

    <script id="page-js">
      function cleanCode(code) {
        return code.trim().replace(/(\r\n|\n|\r|\t)/gm, "");
      }

      function generateBookmarklet() {
        var cssInJS =
          "function touchFuzzy() { var style = document.createElement('style'); style.innerHTML = '" +
          cleanCode(document.getElementById("bookmarklet-css").innerText) +
          "'; document.head.appendChild(style); }";

        var js =
          cssInJS +
          document.getElementById("bookmarklet-js").innerText +
          "touchFuzzy(); getDizzy();";

        var output =
          "javascript:" +
          encodeURIComponent("(function(){" + cleanCode(js) + "})();");

        var link = document.getElementById("bookmarklet-link");
        link.href = output;

        var textarea = document.getElementById("bookmarklet-text");
        textarea.value = output;
      }

      generateBookmarklet();
      getDizzy();
    </script>
  </body>
</html>
